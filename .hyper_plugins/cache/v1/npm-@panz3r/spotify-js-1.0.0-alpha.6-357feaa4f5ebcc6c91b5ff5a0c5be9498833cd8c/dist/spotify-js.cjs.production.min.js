"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("open")),r=e(require("os")),n=e(require("spotify-node-applescript")),o=e(require("dbus-next")),i=require("lodash"),s=function(){function e(){this.supportedActions=["togglePlayPause","previousTrack","nextTrack"]}var t=e.prototype;return t.isRunning=function(){return new Promise((function(e,t){n.isRunning((function(r,n){r?t(r):e(n)}))}))},t.getState=function(){return new Promise((function(e,t){n.getState((function(r,n){r?t(r):e({state:n.state})}))}))},t.getTrack=function(){return new Promise((function(e,t){n.getTrack((function(r,n){r?t(r):e(n)}))}))},t.togglePlayPause=function(){try{var e=this;return Promise.resolve(new Promise((function(e){n.playPause(e)}))).then((function(){return e.getState()}))}catch(e){return Promise.reject(e)}},t.previousTrack=function(){try{var e=this;return Promise.resolve(new Promise((function(e){n.previous(e)}))).then((function(){return e.getTrack()}))}catch(e){return Promise.reject(e)}},t.nextTrack=function(){try{var e=this;return Promise.resolve(new Promise((function(e){n.next(e)}))).then((function(){return e.getTrack()}))}catch(e){return Promise.reject(e)}},e}(),u=function(){function e(){this.supportedActions=[],console.error("Unsupported OS")}var t=e.prototype;return t.isRunning=function(){return Promise.reject("Not implemented")},t.getState=function(){return Promise.reject("Not implemented")},t.getTrack=function(){return Promise.reject("Not implemented")},t.togglePlayPause=function(){try{return Promise.reject("Not implemented")}catch(e){return Promise.reject(e)}},t.previousTrack=function(){try{return Promise.reject("Not implemented")}catch(e){return Promise.reject(e)}},t.nextTrack=function(){try{return Promise.reject("Not implemented")}catch(e){return Promise.reject(e)}},e}();"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),o.setBigIntCompat(!0);var c=function(){function e(){this.supportedActions=["togglePlayPause","previousTrack","nextTrack"],this._getInterfaces()}var t=e.prototype;return t.isRunning=function(){var e=this;return Promise.resolve(function(t,r){try{var n=Promise.resolve(e._getInterfaces()).then((function(e){return!!e.player&&!!e.properties}))}catch(e){return!1}return n&&n.then?n.then(void 0,(function(){return!1})):n}())},t.getState=function(){try{return Promise.resolve(this._getInterfaces()).then((function(e){return Promise.resolve(e.properties.Get("org.mpris.MediaPlayer2.Player","PlaybackStatus")).then((function(e){return{state:i.toLower(e.value)}}))}))}catch(e){return Promise.reject(e)}},t.getTrack=function(){try{return Promise.resolve(this._getInterfaces()).then((function(e){return Promise.resolve(e.properties.Get("org.mpris.MediaPlayer2.Player","Metadata")).then((function(e){var t=i.reduce(e.value,(function(e,t,r){var n=i.last(i.split(r,":"));if(n){var o=t.value;e[n]=i.isArray(o)?i.join(o," & "):o}return e}),{});return t.name=t.title,t}))}))}catch(e){return Promise.reject(e)}},t.togglePlayPause=function(){try{var e=this;return Promise.resolve(e._getInterfaces()).then((function(t){return Promise.resolve(t.player.PlayPause()).then((function(){return e.getState()}))}))}catch(e){return Promise.reject(e)}},t.previousTrack=function(){try{var e=this;return Promise.resolve(e._getInterfaces()).then((function(t){return Promise.resolve(t.player.Previous()).then((function(){return e.getTrack()}))}))}catch(e){return Promise.reject(e)}},t.nextTrack=function(){try{var e=this;return Promise.resolve(e._getInterfaces()).then((function(t){return Promise.resolve(t.player.Next()).then((function(){return e.getTrack()}))}))}catch(e){return Promise.reject(e)}},t._getInterfaces=function(){try{var e=this;return Promise.resolve(e._player&&e._properties?{player:e._player,properties:e._properties}:o.sessionBus().getProxyObject("org.mpris.MediaPlayer2.spotify","/org/mpris/MediaPlayer2").then((function(t){return e._player=t.getInterface("org.mpris.MediaPlayer2.Player"),e._properties=t.getInterface("org.freedesktop.DBus.Properties"),{player:e._player,properties:e._properties}})).catch((function(e){throw e})))}catch(e){return Promise.reject(e)}},e}();exports.SpotifyManager=function(){function e(){switch(r.platform()){case"darwin":this.spotifySrv=new s;break;case"linux":this.spotifySrv=new c;break;default:this.spotifySrv=new u}}var n=e.prototype;return n.launchSpotify=function(){return t("spotify://",{url:!0})},n.supportedActions=function(){return this.spotifySrv.supportedActions},n.isRunning=function(){return this.spotifySrv.isRunning()},n.getState=function(){return this.spotifySrv.getState()},n.togglePlayPause=function(){return this.spotifySrv.togglePlayPause()},n.previousTrack=function(){return this.spotifySrv.previousTrack()},n.nextTrack=function(){return this.spotifySrv.nextTrack()},n.getTrack=function(){return this.spotifySrv.getTrack()},e}();
//# sourceMappingURL=spotify-js.cjs.production.min.js.map
